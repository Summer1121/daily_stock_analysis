# 系统配置清单

为了让系统正常运行，需要配置以下项目。

## 最小配置（必须）

系统最少需要以下配置才能启动运行：

### 1. 股票列表

```bash
# .env 文件
STOCK_LIST=600519,300750,002594
```

| 配置项 | 说明 | 示例值 |
|--------|------|--------|
| `STOCK_LIST` | 自选股代码，逗号分隔 | `600519,300750,002594` |

**股票代码规则：**
- 沪市：6开头（600xxx, 601xxx, 603xxx）
- 深市：000xxx, 002xxx, 300xxx
- 港股：5位数代码或 `hk` 前缀（如 `hk00700`）

### 2. AI 模型（至少配置一个）

**方案一：Gemini（推荐，免费）**

```bash
# .env 文件
GEMINI_API_KEY=your_google_ai_studio_api_key
```

获取方式：
1. 访问 [Google AI Studio](https://aistudio.google.com/)
2. 注册账号并创建 API Key
3. 将 Key 填入配置

**方案二：OpenAI 兼容 API**

```bash
# .env 文件
OPENAI_API_KEY=your_api_key
OPENAI_BASE_URL=https://api.deepseek.com/v1  # 可选
OPENAI_MODEL=deepseek-chat  # 可选
```

支持的模型：
- OpenAI: `gpt-4o-mini`, `gpt-4o` 等
- DeepSeek: `deepseek-chat`
- 通义千问: `qwen-turbo`, `qwen-plus`
- Moonshot: `moonshot-v1-8k`
- 智谱GLM: `glm-4-flash`

---

## 通知配置（可选，但建议配置）

至少配置一个通知渠道，以便接收分析结果：

### 企业微信

```bash
WECHAT_WEBHOOK_URL=https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxx
```

获取方式：
1. 在企业微信群设置中添加群机器人
2. 复制 Webhook 地址

### 飞书

```bash
FEISHU_WEBHOOK_URL=https://open.feishu.cn/open-apis/bot/v2/hook/xxx
```

### Telegram

```bash
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_CHAT_ID=123456789
```

### 邮件

```bash
EMAIL_SENDER=your_email@qq.com
EMAIL_PASSWORD=your_email_auth_code
EMAIL_RECEIVERS=receiver@example.com  # 可选
```

获取邮箱授权码：
- QQ邮箱：设置 → 账户 → POP3/SMTP服务 → 开启

### 自定义 Webhook

```bash
CUSTOM_WEBHOOK_URLS=https://oapi.dingtalk.com/robot/send?access_token=xxx
```

---

## 数据源配置（可选）

### Tushare Pro（推荐配置，提高数据稳定性）

```bash
TUSHARE_TOKEN=your_tushare_token
```

获取方式：
1. 访问 [Tushare Pro](https://tushare.pro/)
2. 注册并获取 Token

---

## 搜索配置（可选）

用于获取股票新闻，建议配置：

### Tavily

```bash
TAVILY_API_KEYS=your_tavily_key
```

获取方式：
1. 访问 [Tavily](https://tavily.com/)
2. 注册并获取 API Key（每月 1000 次免费）

### 博查搜索（中文优化）

```bash
BOCHA_API_KEYS=your_bocha_key
```

获取方式：
1. 访问 [博查搜索](https://open.bocha.cn/)
2. 注册并获取 API Key

---

## 交易配置（可选）

### 模拟交易（默认）

```bash
TRADING_MODE=paper
TRADING_CAPITAL=100000.0
```

### 实盘交易（高级）

```bash
TRADING_MODE=live
TRADING_BROKER=real_api
REAL_BROKER_TYPE=tiger
REAL_BROKER_API_KEY=your_tiger_api_key
REAL_BROKER_API_SECRET=your_tiger_secret
```

---

## 快速开始

### 步骤 1：复制配置模板

```bash
cp .env.example .env
```

### 步骤 2：编辑 .env 文件

至少填写：
- `STOCK_LIST` - 你的股票代码
- `GEMINI_API_KEY` - 你的 AI API Key

### 步骤 3：运行系统

```bash
# 方式一：只运行 WebUI
python main.py --webui-only

# 方式二：运行完整分析
python main.py

# 方式三：调试模式
python main.py --debug
```

### 步骤 4：访问 WebUI

浏览器打开：`http://127.0.0.1:8000`

---

## 完整配置项参考

| 配置项 | 必填 | 默认值 | 说明 |
|--------|------|--------|------|
| `STOCK_LIST` | ✅ | - | 自选股代码列表 |
| `GEMINI_API_KEY` | ⚠️ | - | Gemini API Key（二选一） |
| `OPENAI_API_KEY` | ⚠️ | - | OpenAI 兼容 API Key（二选一） |
| `WECHAT_WEBHOOK_URL` | ❌ | - | 企业微信 Webhook |
| `FEISHU_WEBHOOK_URL` | ❌ | - | 飞书 Webhook |
| `TELEGRAM_BOT_TOKEN` | ❌ | - | Telegram Bot Token |
| `EMAIL_SENDER` | ❌ | - | 发件人邮箱 |
| `EMAIL_PASSWORD` | ❌ | - | 邮箱授权码 |
| `TUSHARE_TOKEN` | ❌ | - | Tushare Token |
| `TAVILY_API_KEYS` | ❌ | - | Tavily API Keys |
| `BOCHA_API_KEYS` | ❌ | - | 博查搜索 API Keys |
| `TRADING_MODE` | ❌ | `paper` | 交易模式 |
| `SCHEDULE_ENABLED` | ❌ | `false` | 是否启用定时任务 |
| `DEBUG` | ❌ | `false` | 调试模式 |

---

## 故障排查

### 问题：启动失败，提示缺少配置

检查 `.env` 文件是否正确配置了 `STOCK_LIST` 和 `GEMINI_API_KEY`。

### 问题：无法获取股票数据

1. 检查网络连接
2. 尝试配置 `TUSHARE_TOKEN` 提高数据稳定性
3. 查看日志文件 `logs/` 目录

### 问题：通知没有收到

1. 检查 Webhook URL 是否正确
2. 测试 Webhook 是否可达
3. 查看日志中的错误信息

### 问题：AI 分析失败

1. 检查 `GEMINI_API_KEY` 是否正确
2. 尝试使用 `OPENAI_API_KEY` 作为备选
3. 查看日志中的具体错误信息
